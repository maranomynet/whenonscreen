// jQuery.fn.whenOnScreen 1.0  - MIT/GPL Licensed - More info: https://github.com/maranomynet/whenonscreen/
(function(e){var t=e(window),l,r=e.whenOnScreen={nsEvents:false,recalcOnResize:true,live:false,leftright:false,range:{visible:{radius:50}},throttle:50},i=function(e,t){var l=/^(-?\d+(?:\.\d+)?)%(s|e)$/.exec(e);var r=l&&parseFloat(l[1])/100;var i=l&&(l[2]==="s"?"scr":"elm")+(/^[TB]/.test(t)?"Height":"Width");return l?function(e){return r*e[i]}:parseInt(e,10)||0},n=function(e,t,l,r,i){var n="_"+i;return!l&&e[n]!=null?e[n]:e[n]=t(r,i)},o=[],s=[],f,a,h=function(l){var i=t.scrollTop(),o=t.height(),h=i+o,c,u,g,m=!l.type,v=m||r.recalcOnResize&&l.type==="resize",p=m?l:s;for(var d=0,w;w=p[d];d++){var E=w.elm,L=v||w.live,b=L&&E.offset(),R=L?w.elmTop=b.top:w.elmTop,B=L?w.elmHeight=E.outerHeight():w.elmHeight,O=L?w.elmBottom=R+B:w.elmBottom,T,y,S;if(w.leftright){if(!d){c=t.scrollLeft();u=t.width();g=c+u}T=L?w.elmLeft=b.left:w.elmLeft;y=L?w.elmWidth=E.outerWidth():w.elmWidth;S=L?w.elmRight=T+y:w.elmRight}var H={scrTop:i,scrHeight:o,scrBottom:h,scrLeft:c,scrWidth:u,scrRight:g,$elm:E,elmTop:R,elmHeight:B,elmBottom:O,elmLeft:T,elmWidth:y,elmRight:S,lastScrTop:f,lastScrLeft:a,leftright:w.leftright};e.each(w.ranges,function(e,t){var l,o=t.top,s=t.bottom;o.call&&(o=n(t,o,L,H,"top"));s.call&&(s=n(t,s,L,H,"bottom"));H.isElmBelow=R-o>=h;H.isElmAbove=i>=O+s;l=!H.isElmBelow&&!H.isElmAbove;if(w.leftright){var f=t.left,a=t.right;f.call&&(f=n(t,f,L,H,"left"));a.call&&(a=n(t,a,L,H,"right"));H.isElmRight=T-f>=g;H.isElmLeft=c>=S+a;l=l&&!H.isElmRight&&!H.isElmLeft}if(l!==t.onscreen){t.onscreen=l;H.type=(l?"whenon":"whenoff")+"screen"+(r.nsEvents?"."+e:"");H.range=t;E.trigger(H)}});f=i;a=c}};e.fn.whenOnScreen=function(n,f){var a="run",c;if(typeof n==="string"){a=n;n=f}n=e.extend({},n);if(a==="run"){c=n.ranges!=null?n.ranges:r.ranges;if(e.isArray(c)){var u=c;c={};e.each(u,function(e,t){c["r"+e]=t})}c=e.isPlainObject(c)?c:{visible:{radius:c}};e.each(c,function(e,t){var l=t.radius||0;delete t.radius;if(t.top==null){t.top=l}if(t.bottom==null){t.bottom=l}if(t.left==null){t.left=l}if(t.right==null){t.right=l}})}var g=this;this.each(function(){var t=this,l=e.inArray(t,o),f=l>-1;if(a==="stop"){if(f){o.splice(l,1);s.splice(l,1)}}else if(a==="data"){g=s[l];return false}else{var u=f?s[l]:{};if(a==="run"){if(!f){o.push(t);s.push(u);u.elm=e(t)}u.leftright=n.leftright!=null?!!n.leftright:!!r.leftright;u.live=n.live!=null?!!n.live:!!r.live;u.ranges={};e.each(c,function(t,l){u.ranges[t]=e.extend({},l)})}e.each(u.ranges,function(t,l){e.each(["Top","Bottom","Left","Right"],function(e,t){var r=t.toLowerCase(),n=l[r];l[r]=n.charAt?i(n,t):n;delete l["_"+r]})});h([u])}});if(!o.length){t.off(".whenOnScreen");l=false}else if(!l){l=true;t.on("scroll.whenOnScreen resize.whenOnScreen",e.throttleFn&&r.throttle?e.throttleFn(h,true,r.throttle):h)}return g}})(jQuery);
