// jQuery.fn.whenOnScreen 1.0  -- (c) 2013 Hugsmi√∞jan ehf.
(function(e){var t=e(window),r,n=50,l=50,i=e.whenOnScreen={range:n,throttle:l},o=[],f=[],s=function(e){var r=t.scrollTop(),n=r+t.height(),l,i;e=e.push?e:f;for(var o=0,s;s=e[o];o++){var h=s.elm,a=s.live?h.offset():null,g=a?a.top:s.elmTop,c=a?g+h.outerHeight():s.elmBottom,u,m;if(s.leftright){l=i?l:t.scrollLeft();i=i||l+t.width();u=a?a.left:s.elmLeft;m=a?u+h.outerWidth():s.elmRight}for(var p=0,v;v=s.ranges[p];p++){var w=g-v.top<n&&r<c+v.bottom;if(w!==v.onscreen){v.onscreen=w;h.trigger({type:w?"whenonscreen":"whenoffscreen",range:v,scrTop:r,scrBottom:n,scrLeft:l,scrRight:i,elmTop:g,elmBottom:c,elmLeft:u,elmRight:m,leftright:s.leftright,live:s.live})}}}};e.fn.whenOnScreen=function(l){var h;if(typeof l==="string"){h=l;l=arguments[1]}l=l||{};if(h!=="stop"){var a=l.ranges!=null?l.ranges:i.ranges!=null?i.ranges:n;if(typeof a==="number"){a=[{radius:a}]}for(var g=0,c;c=a[g];g++){var u=c.radius;if(u!=null){c.top=u;c.bottom=u;c.left=u;c.right=u}}}this.each(function(){var t=this,r=e.inArray(o,t),n=r>0;if(h==="stop"){if(n){o.splice(r,1);f.splice(r,1)}}else{var g={};if(n){g=f[r]}else{o.push(t);f.push(g)}g.elm=t=e(t);g.leftright=!!l.leftright||!!i.leftright;g.live=!!l.live;g.ranges=[];e.each(a,function(){g.ranges.push(e.extend({},this))});if(!l.live&&(!n||h==="update")){var c=g.elm.offset();g.elmTop=c.top;g.elmBottom=c.top+t.outerHeight();if(g.leftright){g.elmLeft=c.left;g.elmRight=c.left+t.outerWidth()}}s([g])}});if(!o.length){t.off(".whenOnScreen");r=false}else if(!r){t.on("scroll.whenOnScreen resize.whenOnScreen",e.throttleFn(s,true,i.throttle))}return this}})(jQuery);