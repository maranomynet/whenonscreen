// jQuery.fn.whenOnScreen 1.0  -- (c) 2013 Hugsmi√∞jan ehf.
(function(e){var t=e(window),r,l=50,n=50,i=e.whenOnScreen={range:l,throttle:n},o=[],f=[],h=function(e){var r=t.scrollTop(),l=r+t.height(),n,i;e=e.push?e:f;for(var o=0,h;h=e[o];o++){var s=h.elm,g=h.live?s.offset():null,u=g?g.top:h.elmTop,a=g?u+s.outerHeight():h.elmBottom,c,m;if(h.leftright){n=i?n:t.scrollLeft();i=i||n+t.width();c=g?g.left:h.elmLeft;m=g?c+s.outerWidth():h.elmRight}for(var p=0,v;v=h.ranges[p];p++){var w=u-v.top<l&&r<a+v.bottom;if(w!==v.onscreen){v.onscreen=w;s.trigger({type:w?"whenonscreen":"whenoffscreen",range:v,scrTop:r,scrBottom:l,scrLeft:n,scrRight:i,elmTop:u,elmBottom:a,elmLeft:c,elmRight:m,leftright:h.leftright,live:h.live})}}}};e.fn.whenOnScreen=function(n){var s="run",g;if(typeof n==="string"){s=n;n=arguments[1]}if(s==="run"){n=n||{};g=n.ranges!=null?n.ranges:i.ranges!=null?i.ranges:l;g=typeof g==="number"?[{radius:g}]:g;for(var u=0,a;a=g[u];u++){var c=a.radius||0;a.top=a.top!=null?a.top:c;a.bottom=a.bottom!=null?a.bottom:c;a.left=a.left!=null?a.left:c;a.right=a.right!=null?a.right:c}}this.each(function(){var t=this,r=e.inArray(o,t),l=r>0;if(s==="stop"){if(l){o.splice(r,1);f.splice(r,1)}}else{var u={};if(l){u=f[r]}if(s!=="recalc"){if(!l){o.push(t);f.push(u);u.elm=t=e(t)}u.leftright=!!n.leftright||!!i.leftright;u.live=!!n.live;u.ranges=[];e.each(g,function(){u.ranges.push(e.extend({},this))})}if(!n.live&&(!l||s==="recalc")){var a=u.elm.offset();u.elmTop=a.top;u.elmBottom=a.top+t.outerHeight();if(u.leftright){u.elmLeft=a.left;u.elmRight=a.left+t.outerWidth()}}if(s==="run"||!u.live){h([u])}}});if(!o.length){t.off(".whenOnScreen");r=false}else if(!r){t.on("scroll.whenOnScreen resize.whenOnScreen",e.throttleFn(h,true,i.throttle));r=true}return this}})(jQuery);